import 'dotenv/config';
import mongoose from 'mongoose';
import { InventoryItem, CalcType, SystemType } from './models/index.js';

const MONGODB_URI = process.env.MONGODB_URI || 'mongodb://localhost:27017/elevator-quote';

// ==========================================
// ุฏุงุฏูโูุง JSON ูุงฺฉุชูุฑ ฺฏุฑูุณ
// ==========================================
const gearlessItems = [
  { "ุดุฑุญ ฺฉุงูุง": "ููุชูุฑ ฺฏุฑูุณ ธ ููุฑู ุขูุจุฑุชู ุณุงุณ ุงุณูพุงูุง", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 105000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 105000000 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงุจู ุชูุงู ุงุณุชู ููฺฉุณ ธ ููุฑู (ููุช ูพุงู)", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 70000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 70000000 },
  { "ุดุฑุญ ฺฉุงูุง": "ูุชุนููุงุช ูฺฉุ ฺฉุงุฑุฏ ูุฒููุ ูพุงุฑุงุดูุช ุฏู ุทุฑูู ู ฺฉูุดฺฉ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 45000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 45000000 },
  { "ุดุฑุญ ฺฉุงูุง": "ููฺฉู ูุฑุฒฺฏุฑุฏ ดฐ ุณูฺฏู ถ ุดุงุฑ ุดูุช ตฐ ุณู ุจูุจุฑูฺฏ ูพุฑูุงู", "ูุงุญุฏ": "ุญููู", "ููุช ูุงุญุฏ": 8500000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 34000000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ุจฺฉุณู ููุฑู ฑฐ ฺฏูุณุชุงูููู ฺู ูุบุฒ ูููุงุฏ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 145000, "ุชุนุฏุงุฏ": 41671, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "1 ุชููู : 5953 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ุจฺฉุณู ููุฑู ถ ฺฏุงููุงูุฒู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 16000, "ุชุนุฏุงุฏ": 1501, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 1501 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุฑูพ ูููุงุฏ ููุฑู ฑฐ ุฏุงฺฉุชู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 7500, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 270000, "fixedQty": 36 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุฑูพ ูููุงุฏ ููุฑู ถ ุฏุงฺฉุชู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 6500, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 39000, "fixedQty": 6 },
  { "ุดุฑุญ ฺฉุงูุง": "ุงุดฺฉ ููุฑู ถ ฺฏุงููุงูุฒู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 10000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 20000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ููุงุจ ุณุฑุจฺฉุณู ููุฑู ฑฐ ุฏุงฺฉุชู ูพุฑุดุง", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 190000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 2280000, "fixedQty": 12 },
  { "ุดุฑุญ ฺฉุงูุง": "ูุงุณุชฺฉ ุฒุฑ ููุชูุฑ ุจุฒุฑฺฏ ูุฑู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 25000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 100000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ูุฒูู ุชุนุงุฏู ุจุชูู ุฑูฺฉุด ููุฒ", "ูุงุญุฏ": "ฺฉูู", "ููุช ูุงุญุฏ": 6000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 5400000, "fixedQty": 900 },
  { "ุดุฑุญ ฺฉุงูุง": "ูพฺ ููุชูุฑ ู ููุฑู ููุฑู ฑธ ุฎูุดฺฉู ููุฑุงู ุจุง ูุงุดุฑ ู ููุฑู ุงุถุงูู", "ูุงุญุฏ": "ุณุฑ", "ููุช ูุงุญุฏ": 85000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 340000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฏุฑุจ ฺฉุงุจู ููู ุงุชููุงุชฺฉ ุฑูฺฏ ุนุฑุถ ธฐ ุงุฑุงู ููุฑุงู ุจุง ฺฉูุงู", "ูุงุญุฏ": "ููฺฏู", "ููุช ูุงุญุฏ": 23000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 23000000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุฑ ุฏุฑ ุขุณุงู ุดุงุงู ููุฑุงู ุจุง ูุชุนููุงุช ฺฉุงูู ู ูุฒูู", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 3400000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 3400000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ูุญุงูุธ ฺฏุงูุฑูุฑ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 180000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 180000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชุงุจูู ณ ูุงุฒ ุงุณุชุงูุฏุงุฑุฏ ณฒ ุขููพุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 950000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 950000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชุงุจูู ูุฑูุงู ฺฏุฑูุณ ูุชูุงุณุจ ุจุง ููุชูุฑ ฑฐ ููุฑู ุขุฑุงู ฺฉูุชุฑู", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 76400000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 76400000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฌุนุจู ุฑูุฒูู ฺฉุงุฑฺฉุฏฺฉ ุขุฑุงู ฺฉูุชุฑู", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 7500000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 7500000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ู ูพ ุงุณ (UPS) ููุฑุงู ุจุง ุจุงุทุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 13000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 13000000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณูุณูุฑ ุดุชุงุจ ุขุฑุงู ฺฉูุชุฑู", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 800000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 800000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุดุงุจููู ุขููุฑุจุง ุขุฑุงู ฺฉูุชุฑู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 40000, "ุชุนุฏุงุฏ": 2, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 2 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุฏ ุงู ู (Drive) ุชุงุจูู ูุฑูุงู", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 4800000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 4800000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุถุฑุจู ฺฏุฑ ฑธฐฐ ฺฉูู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 4200000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 8400000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ููู ู ุฏฺฉุชุงุชูุฑ ู ููุฑ ุฏุฑ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 2500000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 17500000 },
  { "ุดุฑุญ ฺฉุงูุง": "ุดุณุช ุฏุงุฎู ฺฉุงุจู น ุชููู ุชูุงู ุงุชููุงุชฺฉ ฒ ูุชุฑ ุชุงฺ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 12000000, "ุชุนุฏุงุฏ": 1, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 1 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุดุณุช ุทุจูุงุช ุณฺฏููุช ุทุฑุญ ูุชุณูุจุด", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 480000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 3360000 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชุฑุงูู ฺฉุงุจู ฒด ุฑุดุชู ุฏุฑุฌู ฑ ุงุฑุงู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 230000, "ุชุนุฏุงุฏ": 9171, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 9171 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุจุณุช ุชุฑุงูู ฺฉุงุจู ููุงุฏ ูู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 18000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 72000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ููุฑู ฐ.ทต ุงูุดุงู ุงุณุชุงูุฏุงุฑุฏ", "ูุงุญุฏ": "ฺฉูุงู", "ููุช ูุงุญุฏ": 270000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 1890000 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ููุฑู ด ุงูุดุงู ุงุณุชุงูุฏุงุฑุฏ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 16000, "ุชุนุฏุงุฏ": 8331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 8331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ุขููู ถ ุฒูุฌ ุงุณุชุงูุฏุงุฑุฏ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 18000, "ุชุนุฏุงุฏ": 1251, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 1251 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงุจู ด*ฑ ููุฑ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 18000, "ุชุนุฏุงุฏ": 6671, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "1 ุชููู : 953 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ููุงุฑ ฺุณุจ ุฌฺฉ ุงุณูุช", "ูุงุญุฏ": "ุญููู", "ููุช ูุงุญุฏ": 10000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 150000, "fixedQty": 15 },
  { "ุดุฑุญ ฺฉุงูุง": "ููุช ุณูฺ ุดูุงุณุง ูพุฑูุงููโุง ูพุงุฑุณุงู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 105000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 420000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ูพฺ ู ููุฑู ฑฒ ู ฑฐ ุจุง ูุงุดุฑ ุงุถุงูู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 8250, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 165000, "fixedQty": 20 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉูุฏ ุงุณุชูพ ูุงุฑฺ ููุฑุงู ูุงุจ ฺฉุงูู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 62000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 248000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑูุบู ุฏุงู ููุงุฏ ูู ุทุฑุญ ุชุฑฺฉ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 35000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 140000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑูุบู ฺฏุฑ ONSA", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 15000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 60000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุจุณุช ฺฉูุฑุจูุฏ ณฐ ุณุงูุช", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 95000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 95000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุงู ููุฑู ด ููุงุฏ ูู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 32000, "ุชุนุฏุงุฏ": 801, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 801 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุงู ููุฑู น ููุงุฏ ูู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 52500, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 210000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุงู ููุฑู น ููุฒ ุจุง ุฏุฑุจ ูพูุด", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 105000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 420000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ูููู ุฎุฑุทูู ฑถ ููุฒ ุฑูฺฉุด ุฏุงุฑ ููฺฉุณ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 25000, "ุชุนุฏุงุฏ": 3331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 3331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ูููู ุฎุฑุทูู ฑณ ูพูุงุณุชฺฉ ุนุจุฏ", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 18000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 36000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ูพุฑุฒ ุจุงุฑุงู ุฑูฺฉุงุฑ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 32000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 32000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉูุฏ ุชุจุฏู ุตูุนุช ุฑูฺฉุงุฑ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 32000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 64000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณุฑูพฺ ูุนููู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 10000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 20000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ูุงููพ ฑต ูุงุช LED ุฏุงุฎู ฺฉุงุจู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 45000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 90000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺุฑุงุบ ุชููู ุญุจุงุจ ุฏุงุฑ ุณุฑูพฺ ุฏุงุฑ", "ูุงุญุฏ": "ุดุนูู", "ููุช ูุงุญุฏ": 68000, "ุชุนุฏุงุฏ": 2, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 2 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ูุงููพ น ูุงุช LED ุชููู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 32000, "ุชุนุฏุงุฏ": 2, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "7 ุชููู : 2 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ูู ุชููู ฑฐ*ฑฐ ููุฒ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 550000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 2200000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชููู ุฏูุงุฑ ุฑูฺฉุงุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 180000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 360000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุงูุฑููุฏ ุฏุฌุชุงู ฺฏุฑูุณ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 420000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 840000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณูุณูุฑ ููุทูโุง ูุชูุณู ุฏู ฺฉุงูุงู ฺฉุงุจู", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 3600000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 3600000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ูพฺ ุฑูู ูพูุงฺฉ ู ูพุฑฺ ู ูุงุดุฑ", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 1200000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 1200000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุนูุงู ุงุณุชุงูุฏุงุฑุฏ ฺฏุฑูุณ ู ฺฉูุฏ ุณู ฺฏูุด", "ูุงุญุฏ": "ุณุช", "ููุช ูุงุญุฏ": 100000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 200000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุงุฌุฑุช ูุตุจ (ุจุณุช ู ุฑุงูโุงูุฏุงุฒ ููุงุฑุฏ ุฌุฒุฆ)", "ูุงุญุฏ": "ุณุช", "ููุช ูุงุญุฏ": 95000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 95000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ูุตุจ ู ุฑุงู ุงูุฏุงุฒ (ุชููู)", "ูุงุญุฏ": "ุชููู", "ููุช ูุงุญุฏ": 18000000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 126000000 },
];

// ==========================================
// ุฏุงุฏูโูุง JSON ูุงฺฉุชูุฑ ูุฏุฑููฺฉ
// ==========================================
const hydraulicItems = [
  { "ุดุฑุญ ฺฉุงูุง": "ูพุงูุฑ ููุช น/ต ฺฉูููุงุช ุจุฑูุฏ GMV ุงุชุงูุง", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 326000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 326000000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฌฺฉ ุฑููุงู ณ ุชููู นฐ * ต/ตฐ * ต/ต", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 154000000, "ุชุนุฏุงุฏ": 1, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 1 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑุงูพฺุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 9500000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 9500000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุดููฺฏ ุฑูุบู ฑ/ฒ ุงูฺ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 1500000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 7500000, "fixedQty": 5 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑูุบู ูุฏุฑููฺฉ ถธ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 2800000, "ุชุนุฏุงุฏ": 2671, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 2671 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑูุบู ุฑูุงูฺฉุงุฑ ดฐ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 90000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 360000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฏุฑุจ ุทุจูุงุช ูููุง ุฑูฺฏ ุงุฑุงู ุง ุฑูุงูฺฉุงุฑ ุจุงุฒุดู ธฐ ุฏู ููฺฏู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 19500000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 78000000 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฏุฑุจ ุฏุงุฎู ูููุง ุฑูฺฏ ุงุฑุงู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 30000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 60000000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ุจฺฉุณู ููุฑู ฑฐ ุทุฑุญ ฺฏูุณุชุงููู ุขุณุงูุณูุฑ ฺู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 135000, "ุชุนุฏุงุฏ": 33331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 33331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุฑูพ ููุฑู ฑฐ ุฏุงฺฉุชู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 22000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 528000, "fixedQty": 24 },
  { "ุดุฑุญ ฺฉุงูุง": "ููุงุจ ุณุฑ ุจฺฉุณู ฺฉุงุฑุณููฺฏ ููุฑู ฑฐ", "ูุงุญุฏ": "ุฏุณุช", "ููุช ูุงุญุฏ": 320000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 2560000, "fixedQty": 8 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชุงุจูู ูุฑูุงู ูุฏุฑููฺฉ ุจุง ูุงุจูุช AFP", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 58000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 58000000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชุงุจูู ุณู ูุงุฒ ุงุณุชุงูุฏุงุฑุฏ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 1200000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 1200000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุดุงุณ ุฏุงุฎู ฺฉุงุจู ด ุชููู ุชูุงู ุงุชููุงุช ฒ ูุชุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 8500000, "ุชุนุฏุงุฏ": 1, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 1 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุดุงุณ ุทุจูุงุช", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 2500000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 10000000 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงุจู ุชูุงู ููฺฉุณ ฺฉู ุณูฺฏ ุชูุงู ุงุณุชู ุจุง ูุงู ููุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 85000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 85000000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑู T16 ฺู (ุจุง ููุงุฒู)", "ูุงุญุฏ": "ุดุงุฎู", "ููุช ูุงุญุฏ": 8000000, "ุชุนุฏุงุฏ": 2331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 2331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงุฑุงุณููฺฏ ุดุฑฺฉุช cnc", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 55000000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 55000000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺุดู ููุฑ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 4500000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 9000000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุชุฑุงูู ฺฉุงุจู ุทุฑุญ ุฏุชููุฑ ฒด ุฑุดุชู ุชูุงู ูุณ ุฏุช ูุงูุฑ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 325000, "ุชุนุฏุงุฏ": 9331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 9331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุงูุฑููุฏ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 4100000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 4100000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงุฑฺฉุฏฺฉ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 3800000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 3800000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุจุณุช ุชุฑุงูู ฺฉุงุจู ููุงุฏ ูู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 30000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 120000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ููุฑู ฐ/ทต ุงุณุชุงูุฏุงุฑุฏ ูุงุฏ", "ูุงุญุฏ": "ฺฉูุงู", "ููุช ูุงุญุฏ": 350000, "ุชุนุฏุงุฏ": 2, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "2 ุชููู : 1 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ููุฑู ด ุงุณุชุงูุฏุงุฑุฏ", "ูุงุญุฏ": "ฺฉูุงู", "ููุช ูุงุญุฏ": 13000, "ุชุนุฏุงุฏ": 16671, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 16671 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ุณู ถ ุฒูุฌ ุขููู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 50000, "ุชุนุฏุงุฏ": 16671, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 16671 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงุจู ุชููู ฑ*ฒ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 25000, "ุชุนุฏุงุฏ": 13331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 13331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ููุงุฑ ฺุณุจ ุฌฺฉุณูู", "ูุงุญุฏ": "ุญููู", "ููุช ูุงุญุฏ": 12000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 240000, "fixedQty": 20 },
  { "ุดุฑุญ ฺฉุงูุง": "ุขฺุฑ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 200000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 200000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ููุช ุณูฺ ุดูุงุณุง ุดูุงุจ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 270000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 1080000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ูพฺ ู ููุฑู ฑฒ ู ฑฐ ุจุง ูุงุดุฑ ุงุถุงูู", "ูุงุญุฏ": "ุฌูุช", "ููุช ูุงุญุฏ": 12000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 240000, "fixedQty": 20 },
  { "ุดุฑุญ ฺฉุงูุง": "ุณูุณูุฑ ูุบูุงุทุณ ด ุชููู ููุฒ ูพุดุฑู", "ูุงุญุฏ": "ุฏุณุช", "ููุช ูุงุญุฏ": 1200000, "ุชุนุฏุงุฏ": 1, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 1 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉูุฏ ุงุณุชูพ ูุงุฑฺ ููุฑุงู ูพุงู", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 180000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 540000, "fixedQty": 3 },
  { "ุดุฑุญ ฺฉุงูุง": "ุฑูุบู ุฏุงู ุทุฑุญ ุชุฑฺฉ", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 85000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 170000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ุจุณุช ฺฉูุฑุจูุฏ ณฐ ุณุงูุช", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 130000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 260000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ูู ฑฐ*ฑฐ ููุฒ", "ูุงุญุฏ": "ุฏุณุชฺฏุงู", "ููุช ูุงุญุฏ": 320000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 320000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุงู ููุฑู ณ ููุงุฏ ูู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 150000, "ุชุนุฏุงุฏ": 9331, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 9331 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุงู ููุฑู น ููุงุฏ ูู", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 38000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 152000, "fixedQty": 4 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉุงูุงู ููุฑู น ููุฒ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 95000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 190000, "fixedQty": 2 },
  { "ุดุฑุญ ฺฉุงูุง": "ฺฉูุฏ ู ูพุฑุฒ ุจุงุฑุงู", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 60000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 180000, "fixedQty": 3 },
  { "ุดุฑุญ ฺฉุงูุง": "ุนูุงุฆู ุงุณุชุงูุฏุงุฑุฏ ู ฺฉูุฏ ุณู ฺฏูุด", "ูุงุญุฏ": "ุนุฏุฏ", "ููุช ูุงุญุฏ": 300000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 300000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ูููู ุฎุฑุทูู ููุฒ", "ูุงุญุฏ": "ูุชุฑ", "ููุช ูุงุญุฏ": 35000, "ุชุนุฏุงุฏ": 501, "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ": "4 ุชููู : 501 ุนุฏุฏ" },
  { "ุดุฑุญ ฺฉุงูุง": "ูููู ุฎุฑุทูู ูพูุงุณุชฺฉ", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 15000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 15000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ูพฺ ุฑูู ูพูุงฺฉ ู ูพุฑฺ ู ูุงุดุฑ", "ูุงุญุฏ": "ุจุณุชู", "ููุช ูุงุญุฏ": 150000, "ุชุนุฏุงุฏ": "ุซุงุจุช", "ููุช ฺฉู": 150000, "fixedQty": 1 },
  { "ุดุฑุญ ฺฉุงูุง": "ุงุฌุฑุช ูุตุจ ู ุฑุงู ุงูุฏุงุฒ", "ูุงุญุฏ": "-", "ููุช ูุงุญุฏ": 20000000, "ุชุนุฏุงุฏ": "Q = ุชููู", "ููุช ฺฉู": 80000000 },
];

// ==========================================
// ุชุงุจุน ูพุงุฑุณ ฺฉุฑุฏู ูุณุจุช ุชููู
// ==========================================
interface ParsedRatio {
  stops: number;
  qty: number;
}

function parseRatio(text: string): ParsedRatio | null {
  // ุงูฺฏู: "X ุชููู : Y ุนุฏุฏ"
  const match = text.match(/(\d+)\s*ุชููู\s*:\s*(\d+)/);
  if (match) {
    return {
      stops: parseInt(match[1]),
      qty: parseInt(match[2])
    };
  }
  return null;
}

// Meter-based overrides for gearless items (Q ~ k x (stops - 1))
const gearlessMeterOverrides: Record<number, {
  calcType: CalcType;
  ratioStops?: number;
  ratioQty?: number;
  fixedQty?: number;
  formulaText: string;
}> = {
  5: { calcType: 'ratio', ratioStops: 6, ratioQty: 250, formulaText: '6 stops : 250' },
  6: { calcType: 'ratio', ratioStops: 6, ratioQty: 90, formulaText: '6 stops : 90' },
  28: { calcType: 'ratio', ratioStops: 6, ratioQty: 55, formulaText: '6 stops : 55' },
  31: { calcType: 'ratio', ratioStops: 6, ratioQty: 50, formulaText: '6 stops : 50' },
  32: { calcType: 'ratio', ratioStops: 6, ratioQty: 75, formulaText: '6 stops : 75' },
  33: { calcType: 'ratio', ratioStops: 6, ratioQty: 40, formulaText: '6 stops : 40' },
  41: { calcType: 'ratio', ratioStops: 6, ratioQty: 48, formulaText: '6 stops : 48' },
  42: { calcType: 'fixed', fixedQty: 4, formulaText: 'fixed' },
  43: { calcType: 'fixed', fixedQty: 4, formulaText: 'fixed' },
  44: { calcType: 'ratio', ratioStops: 6, ratioQty: 20, formulaText: '6 stops : 20' },
};


// ==========================================
// ุชุงุจุน ุชุจุฏู ุขุชู JSON ุจู ูุฏู ุฏุชุงุจุณ
// ==========================================
interface JsonItem {
  "ุดุฑุญ ฺฉุงูุง": string;
  "ูุงุญุฏ": string;
  "ููุช ูุงุญุฏ": number;
  "ุชุนุฏุงุฏ": string | number;
  "ููุช ฺฉู"?: number;
  "ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ"?: string;
  "fixedQty"?: number;
}

function convertItem(item: JsonItem, category: SystemType, itemId: number) {
  const result: any = {
    itemId,
    name: item["ุดุฑุญ ฺฉุงูุง"],
    unit: item["ูุงุญุฏ"],
    category,
    unitPrice: item["ููุช ูุงุญุฏ"],
    isActive: true,
  };

  const qty = item["ุชุนุฏุงุฏ"];
  const ratioText = item["ุชููู ุจู ูุณุจุช ุชุนุฏุงุฏ"];

  // ุชุนู ููุน ูุญุงุณุจู
  if (qty === "ุซุงุจุช") {
    result.calcType = "fixed";
    // ูุญุงุณุจู ุชุนุฏุงุฏ ุซุงุจุช ุงุฒ ููุช ฺฉู / ููุช ูุงุญุฏ
    if (item.fixedQty) {
      result.fixedQty = item.fixedQty;
    } else if (item["ููุช ฺฉู"] && item["ููุช ูุงุญุฏ"]) {
      result.fixedQty = Math.round(item["ููุช ฺฉู"] / item["ููุช ูุงุญุฏ"]);
    } else {
      result.fixedQty = 1;
    }
    result.formulaText = "ุซุงุจุช";
  } 
  else if (qty === "Q = ุชููู") {
    result.calcType = "per_stop";
    result.formulaText = "Q = ุชููู";
  } 
  else if (ratioText) {
    // ูุณุจุช (ratio)
    const parsed = parseRatio(ratioText);
    if (parsed) {
      result.calcType = "ratio";
      result.ratioStops = parsed.stops;
      result.ratioQty = parsed.qty;
      result.formulaText = ratioText;
    } else {
      // ุงฺฏุฑ ูพุงุฑุณ ูุดุฏุ ุซุงุจุช ุฏุฑ ูุธุฑ ุจฺฏุฑ
      result.calcType = "fixed";
      result.fixedQty = typeof qty === 'number' ? qty : 1;
      result.formulaText = "ุซุงุจุช";
    }
  } 
  else {
    // ูพุดโูุฑุถ: ุซุงุจุช
    result.calcType = "fixed";
    result.fixedQty = typeof qty === 'number' ? qty : 1;
    result.formulaText = "ุซุงุจุช";
  }
  if (category === 'gearless') {
    const override = gearlessMeterOverrides[itemId];
    if (override) {
      result.calcType = override.calcType;
      result.fixedQty = override.fixedQty;
      result.ratioStops = override.ratioStops;
      result.ratioQty = override.ratioQty;
      result.formulaText = override.formulaText;

      if (override.calcType !== 'fixed') {
        result.fixedQty = undefined;
      }

      if (override.calcType !== 'ratio') {
        result.ratioStops = undefined;
        result.ratioQty = undefined;
      }
    }
  }

  return result;
}

// ==========================================
// ุชุงุจุน ุงุตู Seed
// ==========================================
async function seed() {
  try {
    console.log('๐ Connecting to MongoDB...');
    await mongoose.connect(MONGODB_URI);
    console.log('โ Connected to MongoDB Atlas');

    // ูพุงฺฉ ฺฉุฑุฏู ุฏุงุฏูโูุง ูุจู
    await InventoryItem.deleteMany({});
    console.log('๐๏ธ Cleared existing inventory items');

    // ุชุจุฏู ู ุฏุฑุฌ ุขุชูโูุง ฺฏุฑูุณ
    const gearlessData = gearlessItems.map((item, index) => 
      convertItem(item as JsonItem, 'gearless', index + 1)
    );
    
    // ุชุจุฏู ู ุฏุฑุฌ ุขุชูโูุง ูุฏุฑููฺฉ
    const hydraulicData = hydraulicItems.map((item, index) => 
      convertItem(item as JsonItem, 'hydraulic', index + 101)
    );

    // ุฏุฑุฌ ููู ุขุชูโูุง
    const allItems = [...gearlessData, ...hydraulicData];
    await InventoryItem.insertMany(allItems);
    
    console.log(`โ Inserted ${gearlessData.length} gearless items`);
    console.log(`โ Inserted ${hydraulicData.length} hydraulic items`);
    console.log(`๐ Total: ${allItems.length} items`);

    // ููุงุด ฺูุฏ ููููู
    console.log('\n๐ Sample items:');
    const samples = await InventoryItem.find().limit(5);
    samples.forEach(s => {
      console.log(`  - ${s.name} (${s.calcType}): ${s.unitPrice.toLocaleString()} ุชููุงู`);
    });

    console.log('\n๐ Seed completed successfully!');
  } catch (error) {
    console.error('โ Seed error:', error);
    process.exit(1);
  } finally {
    await mongoose.disconnect();
    console.log('๐ Disconnected from MongoDB');
  }
}

seed();


